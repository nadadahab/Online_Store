
version: "3.7"

# Docker Networks
networks:
 app-network:
   driver: bridge

services:
    web: &web
      build:
        context: .
        dockerfile: ./Dockerfile
      volumes:
        - .:/home
      env_file: .env
      container_name: online_store
      image: online_store
      ports:
        - "8000:8000"
      depends_on:
        - mysql
      links:
        - mysql
      networks:
        - app-network

    mysql:
      image: mysql:8.0
      container_name: mysql
      command: --default-authentication-plugin=mysql_native_password
      environment:
        - MYSQL_DATABASE:${DB_DATABASE}
        - MYSQL_USERNAME:${DB_USERNAME}
        - MYSQL_PASSWORD:${DB_PASSWORD}
      ports:
        - 33066:3306
      volumes:
        - ./storage/mysql-data:/var/lib/mysql
        - ./docker/dev/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql
      networks:
        - app-network